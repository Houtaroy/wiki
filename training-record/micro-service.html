<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>微服务 | Houtaroy Wiki</title>
    <meta name="description" content="给时光以生命, 而不是给生命以时光">
    <link rel="stylesheet" href="/wiki/assets/style.5f10c5ca.css">
    <link rel="modulepreload" href="/wiki/assets/chunks/AlgoliaSearchBox.1f22568a.js">
    <link rel="modulepreload" href="/wiki/assets/app.7004e06b.js">
    <link rel="modulepreload" href="/wiki/assets/training-record_micro-service.md.9034774f.lean.js">
    
    <meta name="twitter:title" content="微服务 | Houtaroy Wiki">
  <meta property="og:title" content="微服务 | Houtaroy Wiki">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-2ba227d5><div class="sidebar-button" data-v-2ba227d5><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/wiki/" aria-label="Houtaroy Wiki, back to home" data-v-2ba227d5 data-v-b3da5816><!----> Houtaroy Wiki</a><div class="flex-grow" data-v-2ba227d5></div><div class="nav" data-v-2ba227d5><nav class="nav-links" data-v-2ba227d5 data-v-0fce24fe><!--[--><div class="item" data-v-0fce24fe><div class="nav-link" data-v-0fce24fe data-v-2cb643ba><a class="item" href="/wiki/java/" data-v-2cb643ba>Java <!----></a></div></div><div class="item" data-v-0fce24fe><div class="nav-link" data-v-0fce24fe data-v-2cb643ba><a class="item active" href="/wiki/training-record/micro-service" data-v-2cb643ba>培训记录 <!----></a></div></div><!--]--><!----><!----></nav></div><!--[--><!--[--><div class="algolia-search-box" id="docsearch"></div><!--]--><!--]--></header><aside class="sidebar" data-v-79af364c><nav class="nav-links nav" data-v-79af364c data-v-0fce24fe><!--[--><div class="item" data-v-0fce24fe><div class="nav-link" data-v-0fce24fe data-v-2cb643ba><a class="item" href="/wiki/java/" data-v-2cb643ba>Java <!----></a></div></div><div class="item" data-v-0fce24fe><div class="nav-link" data-v-0fce24fe data-v-2cb643ba><a class="item active" href="/wiki/training-record/micro-service" data-v-2cb643ba>培训记录 <!----></a></div></div><!--]--><!----><!----></nav><!--[--><!--]--><ul class="sidebar-links" data-v-79af364c><!--[--><li class="sidebar-link"><p class="sidebar-link-item">培训记录</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item active" href="/wiki/training-record/micro-service">微服务</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#什么是微服务">什么是微服务</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#cap">CAP</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#base">BASE</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#raft算法">Raft算法</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#微服务模式下的开发">微服务模式下的开发</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#如何选择架构">如何选择架构</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#微服务开发">微服务开发</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#微服务优点">微服务优点</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#微服务缺点">微服务缺点</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#技术栈">技术栈</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#统一身份认证">统一身份认证</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#网关管理">网关管理</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#spring-boot项目接入">Spring Boot项目接入</a><!----></li></ul></li></ul></li></ul></li><!--]--></ul><!--[--><!--]--></aside><div class="sidebar-mask"></div><main class="page" data-v-30e7de44><div class="container" data-v-30e7de44><!--[--><!--]--><div style="position:relative;" class="content" data-v-30e7de44><div><h1 id="微服务" tabindex="-1">微服务 <a class="header-anchor" href="#微服务" aria-hidden="true">#</a></h1><h2 id="什么是微服务" tabindex="-1">什么是微服务 <a class="header-anchor" href="#什么是微服务" aria-hidden="true">#</a></h2><p>微服务是一种架构, 与单体和集群一样, 是业务系统的一种解决方案</p><p>微服务的核心是<strong>分布式</strong>, 与集群有本质的区别</p><p>集群内部<strong>所有服务一致</strong>, 重点在负载均衡抗压, 而分布式是将系统的各个服务进行拆分, 内部的<strong>每个服务职责不同</strong>, 负载均衡只是其的一小部分</p><p>在使用微服务之前, 应熟悉分布式的理论基础: <strong>CAP</strong>和<strong>BASE</strong></p><h3 id="cap" tabindex="-1">CAP <a class="header-anchor" href="#cap" aria-hidden="true">#</a></h3><ul><li>Consistency: 一致性</li><li>Availability: 可用性</li><li>Partition Tolerance: 分区容错性</li></ul><p>在实际业务中该如何考虑实现CAP理论呢?</p><p>首先, 我们应判断系统存不存在分区的情况, 如果存在, 则必须要保证P</p><p>在保证P的前提下, 当前的技术能力无法实现CA, 只能根据实际的业务场景选择C或A</p><p>在不需要保证P的前提下, 可以实现CA, 但不保证P却与分布式的核心冲突</p><div class="language-mermaid"><pre><code><span class="token keyword">graph</span> LR
	A<span class="token text string">{分区?}</span> <span class="token inter-arrow-label"><span class="token arrow-head arrow operator">--</span><span class="token label property">是</span><span class="token arrow operator">--&gt;</span></span> B<span class="token text string">{数据一致?}</span>
	A <span class="token inter-arrow-label"><span class="token arrow-head arrow operator">--</span><span class="token label property">否</span><span class="token arrow operator">--&gt;</span></span> C<span class="token text string">(CA)</span>
	B <span class="token inter-arrow-label"><span class="token arrow-head arrow operator">--</span><span class="token label property">是</span><span class="token arrow operator">--&gt;</span></span> D<span class="token text string">(CP)</span>
	B <span class="token inter-arrow-label"><span class="token arrow-head arrow operator">--</span><span class="token label property">否</span><span class="token arrow operator">--&gt;</span></span> E<span class="token text string">(AP)</span>
</code></pre></div><p><strong>根据业务需求, 选择CP或AP</strong></p><h3 id="base" tabindex="-1">BASE <a class="header-anchor" href="#base" aria-hidden="true">#</a></h3><ul><li>BA(Basically Available): 基本可用</li><li>S(Soft-state): 软状态</li><li>E(Eventually Consistent): 最终一致性</li></ul><p>BASE其实是基于CAP理论, 在实际项目中演化出来的, 是AP生产级别的延申和补充</p><h3 id="raft算法" tabindex="-1">Raft算法 <a class="header-anchor" href="#raft算法" aria-hidden="true">#</a></h3><p>拜占庭将军衍生出的共识算法, 主要有以下角色:</p><ol><li>Leader: 领导者</li><li>Candidate: 候选者</li><li>Follower: 追随者</li></ol><p><img src="/wiki/assets/raft.b78aeb21.png" alt=""></p><p>在CAP理论中, <strong>Raft算法是CP的实现</strong>, 最经典的实现是ZooKeeper</p><h2 id="微服务模式下的开发" tabindex="-1">微服务模式下的开发 <a class="header-anchor" href="#微服务模式下的开发" aria-hidden="true">#</a></h2><p>微服务架构与传统架构从应用场景/思维模式/技术方案上都有着较大的不同</p><p>从开发人员角度, 微服务有一个巨大的优点: <strong>可以显著减少技术债务</strong></p><p>微服务是单体架构的升级与拓展, 并不是单体架构的替代</p><h3 id="如何选择架构" tabindex="-1">如何选择架构 <a class="header-anchor" href="#如何选择架构" aria-hidden="true">#</a></h3><p>单体架构:</p><ol><li>业务稳定</li><li>迭代周期长</li><li>访问压力小</li></ol><p>微服务架构:</p><ol><li>大型/复杂项目</li><li>频繁迭代</li><li>访问压力大</li></ol><h3 id="微服务开发" tabindex="-1">微服务开发 <a class="header-anchor" href="#微服务开发" aria-hidden="true">#</a></h3><p>应熟悉微服务的主要概念和模块:</p><ol><li>服务(资源)</li><li>客户端</li><li>注册中心</li><li>配置中心</li><li>网关</li></ol><p>在设计中需要注意:</p><ol><li>服务职责单一</li><li>数据源单一: 理论上对于同一数据源, 只有一个服务进行写入, 其它只能读取</li><li>分布式ID</li><li>分布式事务</li></ol><h3 id="微服务优点" tabindex="-1">微服务优点 <a class="header-anchor" href="#微服务优点" aria-hidden="true">#</a></h3><ol><li>服务易于开发/维护</li><li>服务启动/运行较快</li><li>松耦合: 局部需求变动很容易迭代</li><li>无技术栈限制</li><li>良好的伸缩性</li><li>高性能/高可用</li><li>减少技术债务</li></ol><h3 id="微服务缺点" tabindex="-1">微服务缺点 <a class="header-anchor" href="#微服务缺点" aria-hidden="true">#</a></h3><ol><li>分布式复杂性</li><li>运维成本高</li><li>重复劳动</li><li>接口调用成本增加: 资源消耗/链路追踪困难</li></ol><p><strong>没有银弹, 任何架构/技术都应服务于需求</strong></p><h2 id="技术栈" tabindex="-1">技术栈 <a class="header-anchor" href="#技术栈" aria-hidden="true">#</a></h2><ul><li>Spring Cloud Alibaba/Spring Boot/Vue</li><li>Nacos</li><li>Spring Cloud Gateway</li><li>OpenFeign</li><li>Spring Cloud Sleuth</li><li>Sentinel</li><li>Seata</li><li>Spring Security 5</li></ul><p>目前已实现的支撑服务有: <strong>统一身份认证/网关动态路由/网关管理</strong></p><h3 id="统一身份认证" tabindex="-1">统一身份认证 <a class="header-anchor" href="#统一身份认证" aria-hidden="true">#</a></h3><p>提供了注册客户端管理/应用管理/组织机构管理/部门管理/用户管理/角色管理/权限管理功能</p><p>并开放应用一级的用户管理/角色管理/权限管理接口</p><h3 id="网关管理" tabindex="-1">网关管理 <a class="header-anchor" href="#网关管理" aria-hidden="true">#</a></h3><p>提供了资源管理/接口管理/路由管理功能</p><h3 id="spring-boot项目接入" tabindex="-1">Spring Boot项目接入 <a class="header-anchor" href="#spring-boot项目接入" aria-hidden="true">#</a></h3><p>后续会提供相关文档</p></div></div><footer class="page-footer" data-v-30e7de44 data-v-504b1bfc><div class="edit" data-v-504b1bfc><div class="edit-link" data-v-504b1bfc data-v-40c300d5><!----></div></div><div class="updated" data-v-504b1bfc><!----></div></footer><!----><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"index.md\":\"3818ae6a\",\"java_springboot整合elasticsearch_index.md\":\"7b633122\",\"java_springboot整合钉钉sdk.md\":\"c26aa1a8\",\"java_springcloud分布式事务seata.md\":\"03353e86\",\"java_index.md\":\"19a7e8a6\",\"java_使用druid解析sql查询语句.md\":\"fed2d013\",\"java_开发手册.md\":\"668b2141\",\"training-record_micro-service.md\":\"9034774f\"}")</script>
    <script type="module" async src="/wiki/assets/app.7004e06b.js"></script>
    
  </body>
</html>